<!DOCTYPE html>
<html>
    <head>
	    <title></title>
    </head>
    <body>
        <h1>Shopping Cart</h1>
        
        <script>
            var cart = []; 
            var Item = function(name, price, count) {
                this.name = name;
                this.price = price;
                this.count = count; 
            }; 

            function addItemToCart(name, price, count) {
                for (var i in cart) {
                    if (cart[i].name === name) { // .name if from Item in cart and === name if from addItemToCart(name)
                        cart[i].count += count; // Add count to whatever the value of count prop is. 
                        return; // This will end the function 
                    }
                }
                var item = new Item(name, price, count); //Executed only if we do not already find the item name in the cart
                cart.push(item);
                saveCart();  
            }
           
            
            function removeItemFromCart(name) { // Removes one item by looking up the name
                for (var i in cart) {
                    if (cart[i].name === name) {
                        cart[i].count--; // cart[i].count = cart[i].count - 1; or cart[i].count -= 1; (same thing)
                        if (cart[i].count === 0) {
                            cart.splice(i, 1); // If count is 0 it removes item from cart completely. or you can put removeItemFromCartAll(); instead of using splice in this case. 
                        }
                        break; 
                    }
                }
                saveCart(); 
            }
            

            function removeItemFromCartAll(name) { // Removes all of a particular item using name.
                for (var i in cart) {
                    if (cart[i].name === name) {
                        cart.splice(i, 1); 
                        break; 
                    }
                }
                saveCart(); 
            }


            addItemToCart("Apple", 1.22, 1);
            addItemToCart("Pear", 1.72, 3);
            addItemToCart("Apple", 1.22, 1); // If we add item as same name as another existing item we need to update count of the existing item.
            addItemToCart("Apple", 1.22, 3);
            addItemToCart("Banana", 1.00, 1);
            addItemToCart("Car", 34.00, 1); 
            addItemToCart("Toy", 5.82, 1);
            addItemToCart("Notes", 4.00, 3);

            console.log(cart.length); // 6 items eventhough it shows 5 when opening it
            console.log(cart);

            removeItemFromCartAll("Car")

            console.log(cart.length); // 5 items and shows 5 when opening it
            console.log(cart);

            function clearCart() {  // Removes everything
                cart = [];
                saveCart(); 
            }
            
            // clearCart(); 
            // console.log(cart);

            function countCart() {  // Count number of items in the cart (returns total count)
                var totalCount = 0;
                for (var i in cart) {
                    totalCount += cart[i].count
                }
                return totalCount; 
            } 

            console.log(countCart());

            function totalCart() {  // Total price of all the items (returns total cost)
                var totalCost = 0; 
                for (var i in cart) {
                    totalCost += cart[i].price
                }
                return totalCost; 
            } 

            console.log(totalCart());

            function listCart() {  // Returns an array of all items (displays it). This helps with debugging
                 var cartCopy = []; 
                 for (var i in cart) { // Looping through each item in the cart
                    var item = cart[i]; 
                    var itemCopy = {};
                    for (var p in item) { // Looping through each property of the item and make that a property in copy and give it the same value.
                        itemCopy[p] = item[p]; 
                    }
                    cartCopy.push(itemCopy); // Adding the itemcopy to the cartcopy
                 }
                 
                 return cartCopy; 
            }


            var array = listCart();  
            array[0].name = "Mistake"; 
            console.log(array); 

            function saveCart() {
                localStorage.setItem("shoppingCart", JSON.stringify(cart)); // parameters represent name and value; JSON is used to convert arrays and objects into a string. LocalStorage needs JSON since it can only store values as strings or numbers. 
            }

            // localStorage.setItem("age", 33); can save things like this. 

            // loadCart()  

        </script>
    </body>
</html>